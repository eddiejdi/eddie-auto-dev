version: '3.8'
services:
  homelab-copilot-agent:
    build:
      context: ..
      dockerfile: homelab_copilot_agent/Dockerfile
    image: homelab-copilot-agent:latest
    container_name: homelab-copilot-agent
    restart: unless-stopped
    network_mode: host
    environment:
      - PORT=8085
      # Ollama roda no host, acess√≠vel via localhost em network_mode: host
      - OLLAMA_HOST=http://127.0.0.1:11434
      - OLLAMA_MODEL=eddie-homelab:latest
      # IPC via PostgreSQL (eddie-postgres no host)
      - DATABASE_URL=postgresql://postgres:eddie_memory_2026@127.0.0.1:5432/postgres
      # API principal para registro e report
      - API_BASE_URL=http://127.0.0.1:8503
      # Scheduler: intervalos em minutos
      - SCHEDULER_PERFORMANCE_INTERVAL=30
      - SCHEDULER_SECURITY_INTERVAL=120
      - SCHEDULER_ARCHITECTURE_INTERVAL=360
