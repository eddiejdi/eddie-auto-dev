[Unit]
Description=Specialized Agents API (On-Demand)
After=network.target docker.service

[Service]
Type=simple
User=home-lab
WorkingDirectory=/home/home-lab/myClaude/specialized_agents
Environment=PATH=/home/home-lab/.local/bin:/usr/local/bin:/usr/bin:/bin
Environment=PYTHONPATH=/home/home-lab/myClaude

# Configurações On-Demand via ambiente
Environment=ONDEMAND_ENABLED=true
Environment=ONDEMAND_AGENT_TIMEOUT=300
Environment=ONDEMAND_DOCKER_TIMEOUT=600
Environment=ONDEMAND_RAG_TIMEOUT=300
Environment=ONDEMAND_GITHUB_TIMEOUT=180
Environment=ONDEMAND_CLEANUP_INTERVAL=60

# Carregar variáveis do .env se existir
EnvironmentFile=-/home/home-lab/myClaude/.env

ExecStart=/home/home-lab/.local/bin/uvicorn api_ondemand:app --host 0.0.0.0 --port 8503
Restart=always
RestartSec=10

# Limites de recursos (leve pois é on-demand)
MemoryMax=512M
CPUQuota=50%

[Install]
WantedBy=multi-user.target
