[Unit]
Description=Ollama GPU1 (GTX 1050) - modelo leve para tarefas paralelas
After=network-online.target ollama.service
Wants=network-online.target

[Service]
User=ollama
Group=ollama
Type=simple
Restart=always
RestartSec=10

# Apenas GPU1 (GTX 1050)
Environment=CUDA_VISIBLE_DEVICES=1
Environment=OLLAMA_HOST=0.0.0.0:11435
Environment=OLLAMA_NUM_GPU=999
Environment=OLLAMA_KEEP_ALIVE=30m
Environment=OLLAMA_LOAD_TIMEOUT=5m
Environment=OLLAMA_KV_CACHE_TYPE=q4_0
Environment=OLLAMA_FLASH_ATTENTION=true
Environment=OLLAMA_NUM_PARALLEL=1
Environment=OLLAMA_MAX_LOADED_MODELS=1
Environment=OLLAMA_MODELS=/usr/share/ollama/.ollama/models

# Threads limitadas (n√£o competir com instancia principal)
Environment=GGML_NUM_THREADS=4
Environment=OLLAMA_NUM_THREADS=4
Environment=OMP_NUM_THREADS=4
CPUAffinity=12-15

ExecStart=/usr/local/bin/ollama serve

[Install]
WantedBy=multi-user.target
